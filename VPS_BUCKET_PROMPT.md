# VPS Transcript Storage Bucket - –û–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è AI –ø—Ä–æ–º–ø—Ç–æ–≤

## –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–∞–∫–µ—Ç–µ

**–¢–∏–ø —Ö—Ä–∞–Ω–∏–ª–∏—â–∞:** VPS (Virtual Private Server) —Ñ–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞
**–¶–µ–ª—å:** –•—Ä–∞–Ω–µ–Ω–∏–µ JSON-—Ñ–∞–π–ª–æ–≤ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ç–æ–≤ –ø–æ–¥–∫–∞—Å—Ç–æ–≤
**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** –õ–æ–∫–∞–ª—å–Ω–∞—è —Ñ–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω–∞ VPS —Å–µ—Ä–≤–µ—Ä–µ

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏

### –°–µ—Ä–≤–µ—Ä
```
IP –∞–¥—Ä–µ—Å: 72.61.186.175
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: root
–ü—É—Ç—å –∫ —Ö—Ä–∞–Ω–∏–ª–∏—â—É: /var/storage/transcript/
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤
```
–§–æ—Ä–º–∞—Ç –∏–º–µ–Ω–∏: {episode_slug}-{lang}-full.json
–ü—Ä–∏–º–µ—Ä—ã:
- episode-123-en-full.json
- podcast-456-ru-full.json
- live-show-789-es-full.json
```

### –¢–∏–ø —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ
```json
{
  "text": "–ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ç–∞",
  "utterances": [
    {
      "start": 0.0,
      "end": 2.5,
      "text": "–¢–µ–∫—Å—Ç —Ä–µ–ø–ª–∏–∫–∏",
      "speaker": "–ò–º—è —Å–ø–∏–∫–µ—Ä–∞",
      "id": "utterance-1"
    }
  ],
  "words": [
    {
      "start": 0.0,
      "end": 0.3,
      "text": "—Å–ª–æ–≤–æ",
      "confidence": 0.95
    }
  ]
}
```

## –°–ø–æ—Å–æ–±—ã –¥–æ—Å—Ç—É–ø–∞ –∫ –±–∞–∫–µ—Ç—É

### 1. –ü—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π –¥–æ—Å—Ç—É–ø (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```javascript
// –ß–µ—Ä–µ–∑ transcriptStorageService.js
import { saveFullTranscriptToStorage } from '@/lib/transcriptStorageService';

const result = await saveFullTranscriptToStorage(episodeSlug, lang, transcriptData);
console.log('–§–∞–π–ª —Å–æ—Ö—Ä–∞–Ω–µ–Ω:', result.url);
// URL: https://dosmundos.pe/files/transcript/{filename}
```

### 2. SCP/SFTP –∑–∞–≥—Ä—É–∑–∫–∞
```bash
# –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
scp local-file.json root@72.61.186.175:/var/storage/transcript/

# –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ —Å —Å–µ—Ä–≤–µ—Ä–∞
scp root@72.61.186.175:/var/storage/transcript/remote-file.json ./local-file.json
```

### 3. SSH –ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø
```bash
ssh root@72.61.186.175
cd /var/storage/transcript/
ls -la
cat episode-123-en-full.json
```

### 4. –í–µ–±-–¥–æ—Å—Ç—É–ø (—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ)
```
https://dosmundos.pe/files/transcript/episode-123-en-full.json
```

## API –±–∞–∫–µ—Ç–∞

### –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–∞
```javascript
saveFullTranscriptToStorage(episodeSlug: string, lang: string, data: object) => Promise<{
  success: boolean,
  url: string,
  error?: string
}>
```

### –û—á–∏—Å—Ç–∫–∞ temp —Ñ–∞–π–ª–æ–≤
```javascript
cleanupTempFiles(maxAgeHours: number = 1) => Promise<{
  success: boolean,
  cleaned: number
}>
```

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

### ‚úÖ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞
- –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –¥–∞–Ω–Ω—ã–º–∏
- –í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –ù–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤–Ω–µ—à–Ω–∏—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- SSH –∏ SCP –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
- –¢—Ä–µ–±—É–µ—Ç SSH –¥–æ—Å—Ç—É–ø–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏
- –ù–µ—Ç –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ CDN
- –†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–º–∏ –∫–æ–ø–∏—è–º–∏
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–æ –º–æ—â–Ω–æ—Å—Ç—å—é VPS —Å–µ—Ä–≤–µ—Ä–∞

### üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- SSH –∫–ª—é—á –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- –§–∞–π–ª—ã –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è —á–µ—Ä–µ–∑ –≤–µ–±
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

## –°—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### 1. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ç–∞
```javascript
const transcriptData = {
  text: "–ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç —ç–ø–∏–∑–æ–¥–∞...",
  utterances: [...],
  words: [...]
};

await saveFullTranscriptToStorage('episode-123', 'en', transcriptData);
```

### 2. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ç–∞
```javascript
const url = 'https://dosmundos.pe/files/transcript/episode-123-en-full.json';
const response = await fetch(url);
const transcript = await response.json();
```

### 3. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–∞–º–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
ssh root@72.61.186.175 "du -sh /var/storage/transcript/"

# –ü–æ–∏—Å–∫ —Ñ–∞–π–ª–æ–≤ –ø–æ —à–∞–±–ª–æ–Ω—É
ssh root@72.61.186.175 "ls /var/storage/transcript/ | grep episode-123"

# –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
ssh root@72.61.186.175 "tar -czf /backup/transcripts-$(date +%Y%m%d).tar.gz /var/storage/transcript/"
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)
```
VPS_IP=72.61.186.175
VPS_USER=root
SUPABASE_SERVICE_ROLE_KEY=your_key_here  # –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ë–î
```

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –∫–æ–¥–µ
```javascript
const VPS_STORAGE_PATH = '/var/storage/transcript';
const VPS_HOST = process.env.VPS_IP || '72.61.186.175';
const VPS_USER = process.env.VPS_USER || 'root';
```

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è
```bash
# –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∞–π–ª–æ–≤
ssh root@72.61.186.175 "ls /var/storage/transcript/ | wc -l"

# –†–∞–∑–º–µ—Ä —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
ssh root@72.61.186.175 "du -sh /var/storage/transcript/"

# –°–≤–æ–±–æ–¥–Ω–æ–µ –º–µ—Å—Ç–æ –Ω–∞ –¥–∏—Å–∫–µ
ssh root@72.61.186.175 "df -h /var"
```

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ logger
- –û—à–∏–±–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ temp —Ñ–∞–π–ª–æ–≤ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è

---

**–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è AI:** "–≠—Ç–æ VPS-based —Ñ–∞–π–ª–æ–≤–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è JSON —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ç–æ–≤. –§–∞–π–ª—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ 72.61.186.175 –≤ /var/storage/transcript/. –î–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ SCP/SSH, –≤–µ–±-URL –¥–ª—è —á—Ç–µ–Ω–∏—è, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ temp —Ñ–∞–π–ª–æ–≤."
